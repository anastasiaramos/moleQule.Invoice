/* UPDATE 4.8.0.0*/

SET SEARCH_PATH = "COMMON";

UPDATE "Variable" SET "VALUE" = '4.8.0.0' WHERE "NAME" = 'INVOICE_DB_VERSION';

SET SEARCH_PATH = "0001";

DROP TABLE IF EXISTS "Traspaso" CASCADE;
CREATE TABLE "Traspaso" ( 
	"OID" bigserial  NOT NULL,
	"OID_CUENTA_ORIGEN" int8 NOT NULL,
	"OID_CUENTA_DESTINO" int8 NOT NULL,
	"OID_USUARIO" int8,
	"SERIAL" bigint,
	"CODIGO" varchar(255),
	"ESTADO" int8,
	"FECHA" timestamp without time zone,
	"OBSERVACIONES" text,
	"IMPORTE" numeric(10,2),
	CONSTRAINT "PK_Traspaso" PRIMARY KEY ("OID")
) WITHOUT OIDS;

ALTER TABLE "Traspaso" OWNER TO moladmin;
GRANT ALL ON TABLE "Traspaso" TO GROUP "MOLEQULE_ADMINISTRATOR";

ALTER TABLE "Traspaso" ADD FOREIGN KEY ("OID_CUENTA_ORIGEN") REFERENCES "COMMON"."CUENTA_BANCARIA" ("OID") ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE "Traspaso" ADD FOREIGN KEY ("OID_CUENTA_DESTINO") REFERENCES "COMMON"."CUENTA_BANCARIA" ("OID") ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE "Traspaso" ADD FOREIGN KEY ("OID_USUARIO") REFERENCES "COMMON"."User" ("OID") ON UPDATE CASCADE ON DELETE RESTRICT;
